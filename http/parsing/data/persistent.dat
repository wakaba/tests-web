#name
HTTP/1.1 -> HTTP/1.1
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
HTTP/1.1 -> HTTP/1.1 Connection: close
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Connection: close"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#status 203
#reason fuga
#headers
Connection: close
Content-Length: 2
#body escaped
ab(close)

#name
HTTP/1.0 Keep-Alive
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.0 202 hoge"CRLF
"Content-Length: 3"CRLF
"Connection: keep-alive"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.0 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#version 1.0
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
HTTP/1.1 -> HTTP/1.0
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.0 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#version 1.0
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
HTTP/1.1 -> HTTP/1.0 Keep-Alive -> HTTP/1.0
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.0 212 fuga--"CRLF
"Content-Length: 2"CRLF
"Connection: keep-alive"CRLF
"x-test-retry: 1"CRLF
CRLF
"ab"
receive "GET"
"HTTP/1.0 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#version 1.0
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
HTTP/1.0 Keep-Alive -> HTTP/1.1 -> HTTP/1.0
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.0 202 hoge"CRLF
"Content-Length: 3"CRLF
"Connection: keep-alive"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.1 212 fuga--"CRLF
"Content-Length: 2"CRLF
"x-test-retry: 1"CRLF
CRLF
"ab"
receive "GET"
"HTTP/1.0 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#version 1.0
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
not reusable
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
CRLF
"anc"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#status 202
#reason hoge
#headers
Content-Length: 3
#body escaped
anc(close)

#name
redundant newline between responses
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
CRLF
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
redundant newline between responses
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
CRLF
CRLF
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
redundant space between responses
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
"   "
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
redundant space between responses
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
"\u0009"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
redundant space between responses
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
"\u000C"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
redundant space between responses
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
"\u000B"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
redundant control between responses
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
"\u007F"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
redundant newline between responses
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
CRLF
CRLF
CRLF
CRLF
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
redundant newline between responses
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
CRLF
CRLF
CRLF
CRLF
receive "GET"
CRLF
CRLF
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
redundant newline between responses
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
CRLF
CRLF
CRLF
CRLF
receive "GET"
CRLF
CRLF
CRLF
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#version 0.9
#status 200
#reason OK
#headers
#body escaped
\u000D
\u000D
\u000D
HTTP/1.1 203 fuga\u000D
Content-Length: 2\u000D
\u000D
ab(close)

#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
receive "GET"
"HTTP/1.1 234 abc"CRLF
"Content-Length: 4"CRLF
CRLF
"xyzw"
close
#test-type second
#status 234
#reason abc
#headers
Content-Length: 4
#body escaped
xyzw(close)

#name
Connection: close
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"A:1"CRLF
"Content-Length: 3"CRLF
"B:2"CRLF
"Connection: close"CRLF
"C:3"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#status 202
#reason hoge
#headers
A: 1
Content-Length: 3
B: 2
Connection: close
C: 3
#body escaped
anc(close)

#name
Connection: close
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Connection: close"CRLF
"Content-Length: 3"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#status 202
#reason hoge
#headers
Connection: close
Content-Length: 3
#body escaped
anc(close)

#name
Connection: close,hoge
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Connection: close,hoge"CRLF
"Content-Length: 3"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#status 202
#reason hoge
#headers
Connection: close,hoge
Content-Length: 3
#body escaped
anc(close)

#name
Connection: close,keep-alive
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Connection: close,keep-alive"CRLF
"Content-Length: 3"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#status 202
#reason hoge
#headers
Connection: close,keep-alive
Content-Length: 3
#body escaped
anc(close)

#name
Connection: keep-alive,close
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Connection: keep-alive,close"CRLF
"Content-Length: 3"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#status 202
#reason hoge
#headers
Connection: keep-alive,close
Content-Length: 3
#body escaped
anc(close)

#name
Connection: keep-alive
Connection: close
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Connection: keep-alive"CRLF
"Connection: close"CRLF
"Content-Length: 3"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#status 202
#reason hoge
#headers
Connection: keep-alive
Connection: close
Content-Length: 3
#body escaped
anc(close)

#name
Connection: close
Connection: keep-alive
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Connection: close"CRLF
"Connection: keep-alive"CRLF
"Content-Length: 3"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#status 202
#reason hoge
#headers
Connection: close
Connection: keep-alive
Content-Length: 3
#body escaped
anc(close)

#name
HTTP/1.0 Connection: keep-alive,close
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.0 202 hoge"CRLF
"Connection: keep-alive,close"CRLF
"Content-Length: 3"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.0 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#version 1.0
#status 202
#reason hoge
#headers
Connection: keep-alive,close
Content-Length: 3
#body escaped
anc(close)

#name
HTTP/1.0 Connection: close,keep-alive
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.0 202 hoge"CRLF
"Connection: close,keep-alive"CRLF
"Content-Length: 3"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.0 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#version 1.0
#status 202
#reason hoge
#headers
Connection: close,keep-alive
Content-Length: 3
#body escaped
anc(close)

#name
HTTP/1.0 Connection: close
Connection: keep-alive
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.0 202 hoge"CRLF
"Connection: close"CRLF
"Connection: keep-alive"CRLF
"Content-Length: 3"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.0 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#version 1.0
#status 202
#reason hoge
#headers
Connection: close
Connection: keep-alive
Content-Length: 3
#body escaped
anc(close)

#name
HTTP/1.0 Connection: keep-alive
Connection: close
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.0 202 hoge"CRLF
"Connection: keep-alive"CRLF
"Connection: close"CRLF
"Content-Length: 3"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.0 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#version 1.0
#status 202
#reason hoge
#headers
Connection: keep-alive
Connection: close
Content-Length: 3
#body escaped
anc(close)

#name
Connection: a b, close ,c
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Connection: a b, close ,c"CRLF
"Content-Length: 3"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#status 202
#reason hoge
#headers
Connection: a b, close ,c
Content-Length: 3
#body escaped
anc(close)

#name
Connection: close
Connection: keep-alive
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 304 hoge"CRLF
"Connection: close"CRLF
"Connection: keep-alive"CRLF
"Content-Length: 3"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#status 304
#reason hoge
#headers
Connection: close
Connection: keep-alive
Content-Length: 3
#body escaped
(close)

#name
Connection: close
Connection: keep-alive
HEAD
#method HEAD
#url /
#data escaped
receive "HEAD"
"HTTP/1.1 200 hoge"CRLF
"Connection: close"CRLF
"Connection: keep-alive"CRLF
"Content-Length: 3"CRLF
CRLF
"anc"
receive "HEAD"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#status 200
#reason hoge
#headers
Connection: close
Connection: keep-alive
Content-Length: 3
#body escaped
(close)

#name
Connection: close
Connection: keep-alive
Content-Length: 0
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 200 hoge"CRLF
"Connection: close"CRLF
"Connection: keep-alive"CRLF
"Content-Length: 0"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
#test-type second
#status 200
#reason hoge
#headers
Connection: close
Connection: keep-alive
Content-Length: 0
#body escaped
(close)

#name
HTTP/1.1 Content-Length: 0 -> HTTP/1.1
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 0"CRLF
"x-test-retry: 1"CRLF
CRLF
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
HTTP/1.1 304 -> HTTP/1.1
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 304 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
Upgrade: in response
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
"Upgrade: WebSocket"CRLF
CRLF
"ab"
close
#test-type second
#status 203
#reason fuga
#headers
Content-Length: 2
Upgrade: WebSocket
#body escaped
ab(close)

#name
Upgrade: in response
#method GET
#url /
#data escaped
receive "GET"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
receive "GET"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
"Upgrade: h2c"CRLF
CRLF
"ab"
close
#test-type second
#status 203
#reason fuga
#headers
Content-Length: 2
Upgrade: h2c
#body escaped
ab(close)

#name
POST -> HTTP/1.1
#method POST
#url /
#data escaped
receive "HTTP"
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry: 1"CRLF
CRLF
"anc"
receive "HTTP"
"HTTP/1.1 203 fuga"CRLF
"Content-Length: 2"CRLF
CRLF
"ab"
close
#test-type second
#status 203
#reason fuga
#headers
Content-Length: 2
#body escaped
ab(close)

#name
POST -> close
#method POST
#url /
#data escaped
receive "POST", start capture
receive "HTTP", end capture
show "req1"
showcaptured
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
CRLF
"anc"
receive "POST", start capture
receive "HTTP", end capture
show "req2"
showcaptured
close
#test-type second
#status 202
#reason hoge
#headers
Content-Length: 3
#body escaped
anc(close)

#name
GET -> close
#method GET
#url /
#data escaped
receive "GET", start capture
receive "HTTP", end capture
show "req1"
showcaptured
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
CRLF
"anc"
receive "GET", start capture
receive "HTTP", end capture
show "req2"
showcaptured
close
#test-type second
#status 202
#reason hoge
#headers
Content-Length: 3
#body escaped
anc(close)

#name
POST -> HTTP/0.9
#method POST
#url /
#data escaped
receive "POST", start capture
receive "HTTP", end capture
show "req1"
showcaptured
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry:1"CRLF
CRLF
"anc"
receive "POST", start capture
receive "HTTP", end capture
show "req2"
showcaptured
"x"
close
#test-type second
#version 0.9
#status 200
#reason OK
#headers
#body escaped
x(close)

#name
POST -> "HTTP/1.1"
#method POST
#url /
#data escaped
receive "POST", start capture
receive "HTTP", end capture
show "req1"
showcaptured
"HTTP/1.1 202 hoge"CRLF
"Content-Length: 3"CRLF
"x-test-retry:1"CRLF
CRLF
"anc"
receive "POST", start capture
receive "HTTP", end capture
show "req2"
showcaptured
"HTTP/1.1"
close
#test-type second
#status 200
#reason OK
#headers
#body escaped
(close)
#incomplete